# Maintainer: Lolix
# Contributor: TilmanV
# Contributor: Dave Blair <mail@dave-blair.de>
# Contributor: Nick Bair <njbair at gmail dot com>

pkgname=bubbleupnpserver
pkgver=0.9.u33
pkgrel=1
pkgdesc="Stream content to Android devices over the Internet, requires UPNP/DNLA backend e.g. miniDLNA, Gerbera, Mediatomb"
arch=(any)
url="http://www.bubblesoftapps.com/bubbleupnpserver/"
license=('custom:BubbleUPnP Server EULA')
depends=('java-runtime>=7')
optdepends=('ffmpeg: for transcoding')
# http://www.bubblesoftapps.com/bubbleupnpserver2/docs/changelog.html
source=(
        bubbleupnpserver.sh
        bubbleupnpserver.service
        bubbleupnpserver.config
        "https://bubblesoftapps.com/bubbleupnpserver/core/bcprov-jdk16-146.jar"
        "https://bubblesoftapps.com/bubbleupnpserver/core/BubbleUPnPServerLauncher.jar"
        "https://bubblesoftapps.com/bubbleupnpserver/core/BubbleUPnPServer.jar"
        "https://bubblesoftapps.com/bubbleupnpserver/core/LICENCE.txt"
# "$pkgname-$(date +%F-%H).zip::http://www.bubblesoftapps.com/bubbleupnpserver/BubbleUPnPServer-distrib.zip"
)
sha256sums=('7df801995e65a79eb5140814ca80c4caeee7e1282b69acff9e74201cbaafdaf3'
            'a78eb3f5d73b2c5dc0f4b32329095d40760905bb1564428a843aa6fb799712c2'
            '61bf63a84b839b85c0fdf0210310c94242bbb6e1aa69bf0d6c46efa013b52ae5'
            'd0ae14598f9c528d2ab7bb8ed00e785a5440f692712cd362d69328aba25efb57'
            '75f31ca14d65f0e077283d15e5715636ea74c7faa0e200c5dd34e6ca50b9a06c'
            '8d13438bfcd37c8df0811da7235c31c2dac7d8bc7b567f02011468760433c3af'
            '69420fd34964ad7404efd9f19fad969f608660af85850fb90d343f2fc6eb9b48')
backup=("etc/conf.d/bubbleupnpserver.config" "var/lib/bubbleupnp/configuration.xml")

package() {

  install -d "${pkgdir}"/var/lib/bubbleupnp
#  chown bubbleupnp:bubbleupnp "${pkgdir}"/var/lib/bubbleupnp

  install -D -m644 "${srcdir}"/bcprov-jdk16-146.jar           "${pkgdir}"/usr/share/${pkgname}/bcprov-jdk16-146.jar
  install -D -m644 "${srcdir}"/BubbleUPnPServerLauncher.jar   "${pkgdir}"/usr/share/${pkgname}/BubbleUPnPServerLauncher.jar
  install -D -m644 "${srcdir}"/BubbleUPnPServer.jar           "${pkgdir}"/usr/share/${pkgname}/BubbleUPnPServer.jar
  install -D -m755 "${srcdir}"/bubbleupnpserver.sh            "${pkgdir}"/usr/bin/bubbleupnpserver
  install -D -m644 "${srcdir}"/bubbleupnpserver.service       "${pkgdir}"/usr/lib/systemd/system/${pkgname}.service
  install -D -m644 "${srcdir}"/bubbleupnpserver.config        "${pkgdir}"/etc/conf.d/bubbleupnpserver.config
  install -D -m644 "${srcdir}"/LICENCE.txt                    "${pkgdir}"/usr/share/licenses/${pkgname}/LICENCE.txt
}
